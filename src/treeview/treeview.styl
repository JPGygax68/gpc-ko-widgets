// TODO: move this into separate stylesheet

.gpc-ko-widget {
  font-family: Arial, Sans-Serif;
  display: inline-block;
  padding: 0.5em;
}

.gpc-ko-widget.treeview {

  // The tree view is based on an unnumbered list, but we remove the decorations and spacing
  
  ul.children {
    margin: 0;
    padding: 0;
    > li {
      list-style-type: none;
      margin-left: 0; // only for the root node, and only if it is not shown
    }
  }
  
  .node {
  
    // The "header" of a node is its first row, where its "handle", label and possibly 
    // additional columns are displayed
    
    > .header {

      display: table;
      
      border: 0;
      margin: 0;
      border-spacing: 0;
      
      // The "main" part of the header row is what contains the "handle" (to show/hide 
      // child nodes) and the "label". The "main" span is separate from any additional
      // ones because this is where indentation occurs, whereas subsequent columns
      // are aligned.
      
      > .main {
      
        display: table-row;
        overflow: hidden;
        
        > * {
          //vertical-align: baseline;
          display: table-cell;
        }
        
        > *:not(:first-child) {
          margin-left: 4px; // TODO: inline styling (property-controlled?)
        }
        
        > .handle {
          //position: relative;
          //top: 4px;
          width: 11+4 px;
          //height: 11px;
          background-position: 0 4px;
          background-repeat: no-repeat;
          user-select: none;
        }

        > .label {
          box-sizing: border-box;
          //padding: 1px 2px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          &:first-child: { padding-left: 0; }
        }
        
      } // > .main
      
      > .value {
        //padding: 1px 2px;
      }
      
      :not(:first-child) {
        margin-left: 0.15em;
      }
      
    } // > .header

    > .children {
      margin-left: 15px;
    }

  }
  
  .node {
    // TODO: generate those in a loop ?
    // Note: :not(:first-child) serves to compensate for the space taken by the "handle" if there is one
    &.level0 > .header .main .label { width: 200px; max-width: 200px; }
    &.level1 > .header .main .label { width: 185px; max-width: 185px; }
    &.level2 > .header .main .label { width: 170px; max-width: 170px; }
    &.level3 > .header .main .label { width: 155px; max-width: 155px; }
    &.level4 > .header .main .label { width: 140px; max-width: 140px; }
    &.level5 > .header .main .label { width: 125px; max-width: 125px; }
    &.level6 > .header .main .label { width: 125px; max-width: 125px; }
    &.level7 > .header .main .label { width: 125px; max-width: 125px; }
    &.level8 > .header .main .label { width: 125px; max-width: 125px; }
    &.level9 > .header .main .label { width: 125px; max-width: 125px; }
  }
  
  // A node not explicitly marked as a "leaf" will have a "handle"
  
  .node.open {
    > .header .main .handle {
      background-image: url('minus.png');
    }
    > .children {
      display: block;
    }
  }
  .node.closed {
    > .header .main .handle {
      background-image: url('plus.png');
    }
    > .children {
      display: none;
    }
  }
  
}
 
// DEBUGGING -------------------
  
if (false)

  .gpc-ko-widget.treeview {

    background-color: orange;
    
    .node {
      background-color: rgba(0, 100, 255, 0.5);
    }
  }

.gpc-ko-widget.treeview {

  .node > .header {
    // > .main > .label { background-color: orange; }
    // > .value { background-color: lime; }
  }
}
